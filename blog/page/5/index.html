
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>syslog.warten.de</title>
  <meta name="author" content="SW">

  
  <meta name="description" content="Die Tastatur meines Dell Latitude D530 erzeugte Zeichen, die nie getippt wurden. Das geschah vor allem in bestimmten Neigungswinkeln des Notebooks, &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://syslog.warten.de/blog/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="syslog.warten.de" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">syslog.warten.de</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:syslog.warten.de" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/03/110/">Die_tastatur_meines_dell_latitude</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-14T00:00:00+01:00" pubdate data-updated="true">Mar 14<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Die Tastatur meines Dell Latitude D530 erzeugte Zeichen, die nie getippt wurden. Das geschah vor allem in bestimmten Neigungswinkeln des Notebooks, was mich eine Art Kurzschluß, eine ungewünschte Kontaktbrücke aufgrund Verschmutzung oder sowas vermuten ließ. Ich wollte die Tastatur ausbauen und prüfen und zu meiner Überraschung findet sich sogar eine detaillierte <a href="http://support.dell.com/support/edocs/systems/latd530/en/sm/index.htm">Anleitung</a> dazu auf den Seiten des Herstellers. Nachdem <a href="http://support.dell.com/support/edocs/systems/latd530/en/sm/keyboard.htm#wp1180225">Hinge Cover</a> und <a href="http://support.dell.com/support/edocs/systems/latd530/en/sm/hingecvr.htm#wp1180224">Keyboard</a> herausgelöst waren, konnte ich es reinigen und seit dem Wiedereinbau ist mein Ghostwriter im Ruhestand.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/03/110/">110</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-14T00:00:00+01:00" pubdate data-updated="true">Mar 14<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Die Tastatur meines Dell Latitude D530 erzeugte Zeichen, die nie getippt wurden. Das geschah vor allem in bestimmten Neigungswinkeln des Notebooks, was mich eine Art Kurzschluß, eine ungewünschte Kontaktbrücke aufgrund Verschmutzung oder sowas vermuten ließ. Ich wollte die Tastatur ausbauen und prüfen und zu meiner Überraschung findet sich sogar eine detaillierte <a href="http://support.dell.com/support/edocs/systems/latd530/en/sm/index.htm">Anleitung</a> dazu auf den Seiten des Herstellers. Nachdem <a href="http://support.dell.com/support/edocs/systems/latd530/en/sm/keyboard.htm#wp1180225">Hinge Cover</a> und <a href="http://support.dell.com/support/edocs/systems/latd530/en/sm/hingecvr.htm#wp1180224">Keyboard</a> herausgelöst waren, konnte ich es reinigen und seit dem Wiedereinbau ist mein Ghostwriter im Ruhestand.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/03/bcc_pro_queue_in_otrs/">Bcc Pro Queue in OTRS</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-12T00:00:00+01:00" pubdate data-updated="true">Mar 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Die Antworten auf Tickets einer bestimmten Queue im <a href="http://otrs.org/">OTRS</a> sollen per Bcc an eine weitere Adresse gesendet werden. Das sieht OTRS bisher nicht vor; die einzige Option ist ein generelles Bcc für alle Queues.<br/>
Um hier Abhilfe zu schaffen, habe ich <code>Kernel/Modules/AgentTicketCompose.pm</code> ein wenig erweitert. Etwa bei Zeile 400 findet sich folgende Methode, bei der die mit Bcc beginnende Zeile wie folgt geändert wird.</p>

<p><code>-Bcc            =&gt; $GetParam{Bcc},
 Bcc            =&gt; $Ticket{QueueID} == 83 ? ('bcc@example.com') : $GetParam{Bcc},</code></p>

<p>Die QueueID (im Beispiel 83) und die Zieladresse müssen selbstverständlich angepaßt werden.</p>

<pre><code># send email
    my $ArticleID = $Self-&gt;{TicketObject}-&gt;ArticleSend(
        ArticleType    =&gt; 'email-external',
        SenderType     =&gt; 'agent',
        TicketID       =&gt; $Self-&gt;{TicketID},
        HistoryType    =&gt; 'SendAnswer',
        HistoryComment =&gt; "%%$Recipients",
        From           =&gt; $GetParam{From},
        To             =&gt; $GetParam{To},
        Cc             =&gt; $GetParam{Cc},
        # Dirty hack to Bcc (forward) answers of tickets from queue id=83.
        #Bcc           =&gt; $GetParam{Bcc},
        Bcc            =&gt; $Ticket{QueueID} == 83 ? ('bcc@example.com') : $GetParam{Bcc},
        Subject        =&gt; $GetParam{Subject},
        UserID         =&gt; $Self-&gt;{UserID},
        Body           =&gt; $GetParam{Body},
        InReplyTo      =&gt; $GetParam{InReplyTo},
        Charset        =&gt; $Self-&gt;{LayoutObject}-&gt;{UserCharset},
        Type           =&gt; 'text/plain',
        Attachment     =&gt; @AttachmentData,
        %ArticleParam,
    );
</code></pre>

<p>Mit ein bisschen mehr Aufwand ließe sich das auch auf mehrere Queues ausweiten sowie die Definition der QueueIDs und Bcc-Adressen in die Konfigurationsdatei auslagern. Das überlasse ich dem geneigten Leser als Hausaufgabe.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/03/zugangsdaten_fur_den_router_siemens/">109</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-09T00:00:00+01:00" pubdate data-updated="true">Mar 9<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Zugangsdaten für den Router Siemens ADSL SL2-141-I im Auslieferungszustand (von Alice DSL):<br/>
- IP-Adresse: 192.168.1.1<br/>
- Benutzername: alice@13184<br/>
- Passwort: hnto$mgmt@lice</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/03/konsistenz_einer_mysql-replika/">Konsistenz Einer MySQL-Replikation Testen</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-04T00:00:00+01:00" pubdate data-updated="true">Mar 4<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Einen einfachen und schnellen Weg, die Datenkonsistenz einer Replikation in MySQL zu überprüfen, bietet mk-table-checksum aus <a href="http://www.maatkit.org/">Maatkit</a>. Das Perl-Skript erstellt Prüfsummen der Tabellen und schreibt diese in eine eigene Tabelle. Durch die Replikation wird diese Tabelle auf den Slave übertragen und dort ebenfalls die Prüfsummen ermittelt. Hinterher lassen sich auf dem Slave die Prüfsummen vergleichen und eventuelle Veränderungen der Datenbestände feststellen. Diese lassen sich dann beispielsweise mit mk-table-sync aus der selben Tool-Sammlung wieder synchronisieren.</p>

<p>Bevor es losgeht, muß auf dem Master eine neue Datenbank (hier <code>test</code>) und die folgende Tabelle erstellt werden.</p>

<pre><code>CREATE TABLE checksum (
    db         char(64)     NOT NULL,
    tbl        char(64)     NOT NULL,
    chunk      int          NOT NULL,
    boundaries char(100)    NOT NULL,
    this_crc   char(40)     NOT NULL,
    this_cnt   int          NOT NULL,
    master_crc char(40)         NULL,
    master_cnt int              NULL,
    ts         timestamp    NOT NULL,
    PRIMARY KEY (db, tbl, chunk)
);
</code></pre>

<p>Danach wird das Skript ausgeführt.</p>

<p><code>mk-table-checksum --replicate=test.checksum h=localhost,u=username,p=password,S=/data/db/mysql.sock</code></p>

<p>Ist das Programm durchgelaufen, kann man hinterher auf dem Slave prüfen, ob die Prüfsummen von Master und Slave abweichend sind.</p>

<pre><code>SELECT db, tbl, chunk, this_cnt-master_cnt AS cnt_diff,
    this_crc  master_crc OR ISNULL(master_crc)  ISNULL(this_crc)
        AS crc_diff
FROM checksum
WHERE master_cnt  this_cnt OR master_crc  this_crc
    OR ISNULL(master_crc)  ISNULL(this_crc);
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/wochenendehttpstackoverflowcomquestions84556whats-your-favorite-programmer-cartoon196006/
/">108</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-26T00:00:00+01:00" pubdate data-updated="true">Feb 26<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p><a href="http://stackoverflow.com/questions/84556/whats-your-favorite-programmer-cartoon/196006">Wochenende!</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/die_vorratsdatenspeicherung_um/">Die Vorratsdatenspeicherung Umgedreht</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-22T00:00:00+01:00" pubdate data-updated="true">Feb 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Wer im Internet unterwegs ist, hinterläßt dabei seine Spuren unter anderem in Form der IP-Adresse des verwendeten Zugangs. Diese Adressen werden von den Providern zum Zweck der Strafverfolgung gespeichert (siehe Vorratsdatenspeicherung). Außerdem kann die IP-Adresse vom Kommunikationspartner, also Webservern, Chatkontakten, Teilnehmern von P2P-Netzwerken usw. gespeichert werden.</p>

<p>Am Wochenende las ich einen haarsträubenden Bericht über den Umgang mit IP-Adressen in straf- und zivilrechtlichen Prozessen, wodurch Unschuldige wegen unbeweisbarer Behauptungen und Übertragungsfehlern zu Unrecht unschöner Dinge verdächtigt wurden. Dabei kam mir die Idee, die Vorratsdatenspeicherung umzudrehen und die von mir benutzten IP-Adressen selbst zu speichern. Sollte ich einmal in die unangenehme Situation kommen, solchen Verdächtigungen ausgesetzt zu sein, kann ich wenigstens für mich selbst überprüfen, ob es wirklich von meinem Anschluß geschah. Ob das juristisch von Bedeutung und bei der eigenen Verteidigung verwertbar ist, weiß ich nicht. Aber es würde wenigstens die eigenen Zweifel ausräumen.</p>

<p>Daher habe ich also eine kleine Lösung entwickelt. Benötigt wird in diesem Fall ein Linux-System mit Perl und MySQL sowie ein Webserver, der CGIs (ebenfalls Perl) ausführen kann.</p>

<p>Zunächst wird ein Datenbankschema mit einer Tabelle angelegt. Die Tabelle wird später zur Speicherung der IP-Adressen und Start- sowie Enddatum deren Nutzung gebraucht.</p>

<pre><code>CREATE DATABASE `remote_addr_logger` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
USE `remote_addr_logger`;
CREATE TABLE IF NOT EXISTS `remote_addr` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `remote_addr` int(10) unsigned NOT NULL COMMENT 'Remote ip address. Use INET_NTOA() to convert.',
  `date_start` datetime NOT NULL COMMENT 'Address used between ...',
  `date_end` datetime NOT NULL COMMENT 'and ...',
  PRIMARY KEY (`id`),
  KEY `remote_addr` (`remote_addr`),
  KEY `date_start` (`date_start`),
  KEY `date_end` (`date_end`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8;
</code></pre>

<p>Für den Zugriff auf die Datenbank wird noch ein Benutzer angelegt.</p>

<pre><code>GRANT SELECT , INSERT , UPDATE ON `remote_addr_logger` . * TO 'remote_addr'@'localhost' IDENTIFIED BY '***';
</code></pre>

<p>Als Nächstes braucht es eine Möglichkeit, die IP-Adresse seines Gateways (DSL-Router etc.) zu ermitteln. Hier gibt es viele Möglichkeiten mit verschiedenen Vor- und Nachteilen. Ich entschied mich kurzerhand für ein winziges CGI-Skript, das später vom Hauptprogramm via HTTP request aufgerufen werden soll und die eigene remote address in einem kleinen XML output ausgibt.</p>

<pre><code>#!/usr/bin/perl

my $remote_addr = $ENV{'REMOTE_ADDR'};

print "Content-type: text/htmlnn";
print "n";
print "$remote_addrn";
</code></pre>

<p>Nun fehlt nur noch das Hauptprogramm, das das CGI-Skript aufruft, die XML-Datei empfängt und auswertet und die IP-Adresse samt Datum in die Datenbank schreibt. Hier sind zu Beginn die URL des CGI-Skripts sowie die Zugangsdaten zur Datenbank einzutragen.</p>

<pre><code>#!/usr/bin/perl

use strict;
use warnings;
use LWP::Simple;
use DBI;

my $get_remote_addr_cgi_url = 'http://example.com/cgi-bin/get_remote_addr.cgi';

my $db_name = 'remote_addr_logger';
my $db_host = 'localhost';
my $db_user = 'remote_addr';
my $db_pass = 'yoursecretpassword';

sub parse_xml_data {
    my $xml_data = shift;
    my $tag = 'remote_addr';
    my $inet_addr = '(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)';
    my $pattern = "($inet_addr)";
    if ( $xml_data =~ /$pattern/ ) {
        my $remote_addr = $1;
        return $remote_addr;
    } else {
        return -1;
    }
}

sub get_remote_addr {
    my $xml_data = get($get_remote_addr_cgi_url);
    if ( defined( $xml_data )) {
        my $remote_addr = parse_xml_data( $xml_data );
        return $remote_addr;
    } else {
        return -1;
    }
}

my $remote_addr = get_remote_addr();
unless ( $remote_addr eq -1 ) {
    my $dsn = "dbi:mysql:$db_name:$db_host";
    my $dbh = DBI-&gt;connect($dsn, $db_user, $db_pass);
    my ($id) = $dbh-&gt;selectrow_array("SELECT `id` FROM `remote_addr` WHERE `remote_addr` = INET_ATON( '$remote_addr' ) AND `id` IN ( SELECT MAX(`id`) FROM `remote_addr`);");
    if ( defined($id) and $id gt 0 ) {
        $dbh-&gt;do("UPDATE `remote_addr` SET `date_end` = NOW() WHERE `id`=$id;");
    } else {
        $dbh-&gt;do("INSERT INTO `remote_addr` ( `remote_addr`, `date_start`, `date_end` ) VALUES ( INET_ATON( '$remote_addr'), NOW(), NOW() );");
    }
    $dbh-&gt;disconnect;
}
</code></pre>

<p>Die Funktionsweise ist recht simpel. Die IP-Adresse wird mit der des letzten Eintrags in der Tabelle verglichen. Hat sie sich nicht geändert, wird das Enddatum mit der aktuellen Zeit aktualisiert. Ist es eine andere Adresse, wird ein neuer Eintrag eingefügt.<br/>
Jetzt muß das Skript nur noch regelmäßig aufgerufen werden. Sinnvollerweise erledigt das cron.</p>

<p><code>*/1 * * * * /usr/local/bin/remote_addr_logger</code></p>

<p>Die Einträge können wie folgt aus der Datenbank ausgelesen werden:</p>

<pre><code>SELECT INET_NTOA(`remote_addr`), `date_start`, `date_end` FROM `remote_addr`;
</code></pre>

<p>Und jetzt bin ich mal gespannt…</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/the_weird_sense_of_duty/">107</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-22T00:00:00+01:00" pubdate data-updated="true">Feb 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p><em>The weird sense of duty really good sysadmins have can border on the sociopathic, but it’s nice to know that it stands between the forces of darkness and your cat blog’s servers.</em> (<a href="http://imgs.xkcd.com/comics/devotion_to_duty.png">xkcd</a>)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/01/der_von_t-home_ausgelieferte_speedport/">105</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-23T00:00:00+01:00" pubdate data-updated="true">Jan 23<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p>Der von T-Home ausgelieferte Speedport W 920V kann nicht mit anderen DSL-Providern verwendet werden. Es ist jedoch möglich, die Firmware durch die einer FRITZ!Box Fon WLAN 7270 zu ersetzen. Das Gerät kann danach auch mit anderen Providern benutzt werden und bietet zusätzliche Features. Wie das funktioniert, erklärt diese <a href="http://www.ip-phone-forum.de/showthread.php?t=172137">Anleitung</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/01/asciimeohttpwwwasciimeocom/">104</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-22T00:00:00+01:00" pubdate data-updated="true">Jan 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h1></h1>

<p><a href="http://www.asciimeo.com/">ASCIImeo</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/05/26/build-spotify-rpm-on-fedora/">Build Spotify RPM on Fedora</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/26/backup-synology-nas-using-rsync/">Backup Synology NAS using rsync</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/16/hello-world/">Hello world</a>
      </li>
    
      <li class="post">
        <a href="/2012/06/simple-sftp-setup/">Simple SFTP setup</a>
      </li>
    
      <li class="post">
        <a href="/2012/05/425/">425</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sw0x2A">@sw0x2A</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sw0x2A',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - SW -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
